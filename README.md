# Speakeasy Python Client Library

## Getting started
0. Install
```shell
pip install speakeasypy
```

1. Initialize the Speakeasy Python framework and login.
```python
from speakeasypy import Speakeasy
speakeasy = Speakeasy(host='https://speakeasy.ifi.uzh.ch', username='name', password='pass')
speakeasy.login()  
# This framework will help you log out automatically when the program terminates.
```

2. Get chatrooms.
```python
# Only check active chatrooms (i.e., remaining_time > 0) if active=True.
rooms = speakeasy.get_rooms(active=True)
```

3. Check messages and reactions in each chatroom, then post your messages to the corresponding room.

```python
for room in rooms:
    # Retrieve messages from this chat room.
    # If only_partner=True, it filters out messages sent by the current bot.
    # If only_new=True, it filters out messages that have already been marked as processed.
    for message in room.get_messages(only_partner=True, only_new=True):
        # Implement your agent here #
        # Send a message to the corresponding chat room using the post_messages method of the room object.
        room.post_messages(f"Received your message: '{message.message}' ")
        # Mark the message as processed, so it will be filtered out when retrieving new messages.
        room.mark_as_processed(message)
    # Retrieve reactions from this chat room.
    # If only_new=True, it filters out reactions that have already been marked as processed.
    for reaction in room.get_reactions(only_new=True):
        # Implement your agent here #
        room.post_messages(f"Received your reaction: '{reaction.type}' ")
        room.mark_as_processed(reaction)
```

*Note: Each API endpoint has an embedded rate limit. If the rate of calls to an endpoint (e.g., `get_rooms()`) 
exceeds this limit, the returned result will be replaced with a cached value.

## Development
This pacakge `speakeasypy` depends on an internal package `speakeasypy.openapi.client` which is generated by openapi. 
Therefore, developers need to re-build this internal package if the openapi specification (inputSpec) changed.

Install `speakeasypy` locally:
```shell
python setup.py install
````
Distribute `speakeasypy` and test it locally:
```shell
python setup.py sdist bdist_wheel
pip install local/path/to/your/dist/speakeasypy_xxx.whl
```

